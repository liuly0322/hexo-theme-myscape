<% if (config.disqus_shortname){ %>
<script>
  var disqus_shortname = '<%= config.disqus_shortname %>';
  <% if (page.permalink){ %>
  var disqus_url = '<%= page.permalink %>';
  <% } %>
  (function(){
    var dsq = document.createElement('script');
    dsq.async = true;
    dsq.src = 'https://' + disqus_shortname + '.disqus.com/<% if (page.comments) { %>embed.js<% } else { %>count.js<% } %>';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<% } %>

<%- js('js/jquery-3.4.1.min.js') %>

<% if (theme.fancybox){ %>
  <%- js('fancybox/jquery.fancybox.min.js') %>
<% } %>

<%- js('js/script') %>

<%- js('js/local-search') %>

<%- partial('gauges-analytics') %>

<% if (is_home() || theme.mermaid.enable && page.mermaid) { %>
  <script src='https://cdn.jsdelivr.net/npm/mermaid@8.12.0/dist/mermaid.min.js'></script>
  <script>
    if (window.mermaid) {
      mermaid.initialize("");
      const mermaids = document.querySelectorAll('.mermaid');
      function wait(){
        if (mermaids[0].querySelector('svg') == null) {
          setTimeout("wait()", 100)
          return;
        }
        for (let i = 0; i < mermaids.length; i++) {
          mermaids[i].querySelector('svg').setAttribute('height','100%');
        }
      }
      if(mermaids.length){
        wait();
      }
    }
  </script>
<% } %>


<% if(theme.valine.enable && theme.valine.appId && theme.valine.appKey){ %>
  <%- js('https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.Pure.min.js') %>
<script>
    var notify = '<%= theme.valine.notify %>' == true;
    var verify = '<%= theme.valine.verify %>' == true;
    new Valine({
        el: '.vc',
        appId: "<%= theme.valine.appId %>",
        appKey: "<%= theme.valine.appKey %>",
        placeholder: "<%= theme.valine.placeholder %>",
        pageSize:'<%= theme.valine.pageSize %>',
        avatar:'<%= theme.valine.avatar %>'
    });
</script>
<% } %>